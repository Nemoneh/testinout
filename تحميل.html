<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <div style="margin-top: 40px; font-size: 20px; font-weight: bold; color: #333;">   <span style="color: #007bff;">___________________________________</span></div>
  <div style="margin-top: 40px; font-size: 20px; font-weight: bold; color: #333;"> ุชุตููู ูุชูููุฐ: <span style="color: #007bff;">ุฃ.ูุงููู ุฌุฑู </span></div>
  <div style="margin-top: 40px; font-size: 20px; font-weight: bold; color: #333;"> ุจุฃุดุฑุงู: <span style="color: #007bff;">ุฃ. ูุญููุฏ ุฒูุฏุงู </span></div>
  <title>ุชุญููู ุฃุณูุงุก ุงูุทูุงุจ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      text-align: center;
    }
    select, input[type="file"], button {
      margin: 10px;
      padding: 8px;
      font-size: 16px;
    }
    table {
      margin: 20px auto;
      border-collapse: collapse;
      width: 80%;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 10px;
    }
    th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>

<h2>๐ฅ ุชุญููู ุฃุณูุงุก ุงูุทูุงุจ ูู ููู Excel</h2>
<button onclick="window.location.href='ุงุฎุชูุงุฑ.html'" style="background-color:#007bff; color:white; margin-top:20px;">
๐ ุฑุฌูุน ุฅูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
</button>

<label>ุงุฎุชุฑ ุงูุตู:</label>
<select id="gradeSelect">
  <option value="ุงูุตู ุงูุฎุงูุณ">ุงูุตู ุงูุฎุงูุณ</option>
  <option value="ุงูุตู ุงูุณุงุฏุณ">ุงูุตู ุงูุณุงุฏุณ</option>
  <option value="ุงูุตู ุงูุณุงุจุน">ุงูุตู ุงูุณุงุจุน</option>
  <option value="ุงูุตู ุงูุซุงูู">ุงูุตู ุงูุซุงูู</option>
</select>

<label>ุงุฎุชุฑ ุงูุดุนุจุฉ:</label>
<select id="sectionSelect">
  <option value="A">A</option>
  <option value="B">B</option>
  <option value="C">C</option>
  <option value="D">D</option>
  <option value="E">E</option>
</select>

<br>
<input type="file" id="fileInput" accept=".xlsx, .xls">
<button onclick="handleUpload()">ุชุญููู ุงูููู</button>

<h3>๐ ูุงุฆูุฉ ุงูุทูุงุจ:</h3>
<table id="studentsTable">
  <thead>
    <tr><th>ุงูุงุณู</th></tr>
  </thead>
  <tbody></tbody>
</table>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
  function handleUpload() {
    const file = document.getElementById("fileInput").files[0];
    const grade = document.getElementById("gradeSelect").value;
    const section = document.getElementById("sectionSelect").value;

    if (!file) {
      alert("ูุฑุฌู ุงุฎุชูุงุฑ ููู Excel ุฃููุงู");
      return;
    }

    const reader = new FileReader();
    reader.onload = function (e) {
      const data = new Uint8Array(e.target.result);
      const workbook = XLSX.read(data, { type: "array" });
      const sheetName = workbook.SheetNames[0];
      const sheet = workbook.Sheets[sheetName];
      const students = XLSX.utils.sheet_to_json(sheet, { header: 1 });

      const tbody = document.querySelector("#studentsTable tbody");
      tbody.innerHTML = "";

      students.forEach(row => {
        if (row[0]) {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${row[0]}</td>`;
          tbody.appendChild(tr);
        }
      });

      // ุญูุธ ูุคูุช ูู localStorage
      const key = `${grade}_${section}`;
      const names = students.map(row => row[0]).filter(name => name);
      localStorage.setItem(key, JSON.stringify(names));
      alert(`ุชู ุชุญููู ${names.length} ุทุงูุจ ููุดุนุจุฉ ${section} ูู ${grade}`);
    };

    reader.readAsArrayBuffer(file);
  }
</script>

</body>
</html>

